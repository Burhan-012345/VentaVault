{% extends "base.html" %}

{% block title %} - Enter PIN{% endblock %}

{% block content %}
<div class="pin-lock-container">
    <!-- Security Scan Animation -->
    <div class="security-scan">
        <div class="scan-line"></div>
        <div class="scan-glow"></div>
    </div>
    
    <!-- Vault Icon -->
    <div class="vault-icon">
        <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
            <circle cx="12" cy="15" r="2"></circle>
        </svg>
    </div>
    
    <!-- Title -->
    <h1 class="app-title">VantaVault</h1>
    <p class="app-subtitle">Secure Media Storage</p>
    
    <!-- PIN Display -->
    <div class="pin-display">
        <div class="pin-dots">
            {% for i in range(6) %}
            <div class="pin-dot" data-index="{{ i }}"></div>
            {% endfor %}
        </div>
        <div class="pin-input" id="pinValue"></div>
    </div>
    
    <!-- Fingerprint Prompt -->
    <div class="fingerprint-prompt" id="fingerprintPrompt" style="display: none;">
        <button class="fingerprint-btn" onclick="attemptFingerprint()">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 0 0 8 11a4 4 0 1 1 8 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0 0 15.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 0 0 8 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4"/>
            </svg>
            <span>Use Fingerprint</span>
        </button>
    </div>
    
    <!-- Numeric Keypad -->
    <div class="keypad">
        <div class="keypad-row">
            <button class="keypad-btn" data-key="1">1</button>
            <button class="keypad-btn" data-key="2">2</button>
            <button class="keypad-btn" data-key="3">3</button>
        </div>
        <div class="keypad-row">
            <button class="keypad-btn" data-key="4">4</button>
            <button class="keypad-btn" data-key="5">5</button>
            <button class="keypad-btn" data-key="6">6</button>
        </div>
        <div class="keypad-row">
            <button class="keypad-btn" data-key="7">7</button>
            <button class="keypad-btn" data-key="8">8</button>
            <button class="keypad-btn" data-key="9">9</button>
        </div>
        <div class="keypad-row">
            <button class="keypad-btn" id="clearBtn">âŒ«</button>
            <button class="keypad-btn" data-key="0">0</button>
            <button class="keypad-btn" id="submitBtn">â†µ</button>
        </div>
    </div>
    
    <!-- Security Info -->
    <div class="security-info">
        <p>ðŸ”’ All data encrypted locally</p>
        <p>ðŸ“± Install as PWA for best experience</p>
    </div>
</div>

<!-- Hidden Form for Fake Vault -->
<div id="fakeVaultForm" style="display: none;">
    <input type="checkbox" id="fakeVaultToggle">
    <label for="fakeVaultToggle">Decoy Mode</label>
</div>
{% endblock %}

{% block scripts %}
<script src="/static/js/auth.js"></script>
<script>
    // Initialize PIN lock
    const pinLock = new PinLock();
    pinLock.init();
    
    // Check if fingerprint is available
    if (window.PublicKeyCredential) {
        document.getElementById('fingerprintPrompt').style.display = 'block';
    }
    
    // Auto-focus on app load
    document.addEventListener('DOMContentLoaded', () => {
        // Start security scan animation
        gsap.to('.scan-line', {
            y: '100%',
            duration: 2,
            repeat: -1,
            ease: 'power1.inOut'
        });
    });
</script>
{% endblock %}